"0","dat=rep(1,5)"
"0","## simulate basic epicurvedat <- c(0, 2, 2, 3, 3, 5, 5, 5, 6, 6, 6, 6)"
"0","i <- incidence(dat)  # 20 cases to start with"
"0","# plot(i)"
"0","# SI"
"0","mean_SI <- 14.2"
"0","CV_SI <- 9.6/14.2 # from http://www.nejm.org/doi/suppl/10.1056/NEJMc1414992/suppl_file/nejmc1414992_"
"0","# params <- gamma_mucv2shapescale(mean_SI, CV_SI)"
"0","# si <- distcrete(""gamma"", interval = 1L,"
"0","#                   shape = params$shape,"
"0","#                   scale = params$scale, w = 0.5)"
"0","# si$d(0:30) # problem of first one"
"0","SItrunc <- 40"
"0","# serial distribution"
"0","SI_Distr <- sapply(0:SItrunc, function(e) DiscrSI(e,mean_SI,mean_SI*CV_SI) )"
"0","SI_Distr <- SI_Distr / sum(SI_Distr)"
"0","#simulate 40 days"
"0","pred <- project(x = i, R = c(1.5,1.5), R_fix_within = TRUE,"
"0","                si = SI_Distr, n_days = 150, n_sim = 50)"
"0","# keep incidence of last 20 days"
"0","incidence <- data.frame(date = as.Date('01/05/2018',format='%d/%m/%Y')+seq(0,4*7-1),"
"0","                        I = tail(pred,4*7))"
"0","f <- which(colSums(incidence[,-1])==0) # remove location with 0 cases in last 20 days"
"0","if (length(f)>0) incidence <- incidence[,-(f+1)]"
"0","incidence <- incidence[,1:11]"
"0","# I_cum_hist <- colSums(head(pred,150-20))"
"0","save(incidence, file = 'simulated.RData')"
